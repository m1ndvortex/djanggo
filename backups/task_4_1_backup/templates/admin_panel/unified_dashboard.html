{% extends 'admin_panel/base_unified.html' %}
{% load static %}

{% block title %}داشبورد یکپارچه مدیریت - پنل مدیریت زرگر{% endblock %}

{% block page_header %}
<div class="bg-white dark:bg-cyber-bg-secondary rounded-lg shadow-lg dark:shadow-2xl p-6 mb-6">
    <div class="flex justify-between items-center">
        <div>
            <h1 class="text-3xl font-bold text-gray-900 dark:text-cyber-text-primary">داشبورد یکپارچه مدیریت</h1>
            <p class="text-gray-600 dark:text-cyber-text-secondary mt-2">مدیریت کامل و یکپارچه سیستم زرگر</p>
        </div>
        <div class="flex space-x-3 space-x-reverse">
            <!-- Theme Toggle -->
            <button @click="toggleTheme()" 
                    class="p-3 rounded-lg bg-gray-100 dark:bg-cyber-bg-surface hover:bg-gray-200 dark:hover:bg-cyber-bg-elevated transition-all duration-300 group">
                <svg x-show="!darkMode" class="w-6 h-6 text-gray-600 group-hover:text-gray-800 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                </svg>
                <svg x-show="darkMode" class="w-6 h-6 text-cyber-neon-primary group-hover:text-cyber-neon-primary/80 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
            </button>
            
            <!-- Quick Actions -->
            <a href="{% url 'admin_panel:tenants:tenant_create' %}" 
               class="bg-primary-600 dark:bg-cyber-neon-primary hover:bg-primary-700 dark:hover:bg-cyber-neon-primary/80 text-white px-6 py-3 rounded-lg transition-all duration-300 font-medium shadow-lg dark:shadow-cyber-neon-primary/20">
                ایجاد تنانت جدید
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}
<!-- Real-time Statistics Dashboard -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8" x-data="statisticsData()">
    <!-- Total Tenants -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6 hover:shadow-xl dark:hover:shadow-cyber-neon-primary/10 transition-all duration-300">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-blue-100 dark:bg-cyber-neon-primary/20 group-hover:bg-blue-200 dark:group-hover:bg-cyber-neon-primary/30 transition-colors">
                <svg class="w-8 h-8 text-blue-600 dark:text-cyber-neon-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                </svg>
            </div>
            <div class="mr-4">
                <p class="text-sm font-medium text-gray-600 dark:text-cyber-text-secondary">کل تنانت‌ها</p>
                <p class="text-3xl font-bold text-gray-900 dark:text-cyber-text-primary persian-numbers" x-text="totalTenants">
                    {{ total_tenants }}
                </p>
                <p class="text-xs text-green-600 dark:text-cyber-neon-secondary mt-1">
                    <span class="persian-numbers">+{{ new_tenants_this_month }}</span> این ماه
                </p>
            </div>
        </div>
    </div>

    <!-- Active Tenants -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6 hover:shadow-xl dark:hover:shadow-cyber-neon-secondary/10 transition-all duration-300">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-green-100 dark:bg-cyber-neon-secondary/20">
                <svg class="w-8 h-8 text-green-600 dark:text-cyber-neon-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
            </div>
            <div class="mr-4">
                <p class="text-sm font-medium text-gray-600 dark:text-cyber-text-secondary">تنانت‌های فعال</p>
                <p class="text-3xl font-bold text-gray-900 dark:text-cyber-text-primary persian-numbers" x-text="activeTenants">{{ active_tenants }}</p>
                <p class="text-xs text-gray-500 dark:text-cyber-text-muted mt-1">
                    <span class="persian-numbers">{{ active_percentage }}%</span> از کل
                </p>
            </div>
        </div>
    </div>

    <!-- Total Revenue -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6 hover:shadow-xl dark:hover:shadow-cyber-neon-warning/10 transition-all duration-300">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-yellow-100 dark:bg-cyber-neon-warning/20">
                <svg class="w-8 h-8 text-yellow-600 dark:text-cyber-neon-warning" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                </svg>
            </div>
            <div class="mr-4">
                <p class="text-sm font-medium text-gray-600 dark:text-cyber-text-secondary">کل درآمد</p>
                <p class="text-3xl font-bold text-gray-900 dark:text-cyber-text-primary persian-numbers" x-text="formatCurrency(totalRevenue)">
                    {{ total_revenue|floatformat:0 }} تومان
                </p>
                <p class="text-xs text-green-600 dark:text-cyber-neon-secondary mt-1">
                    <span class="persian-numbers">+{{ revenue_growth }}%</span> رشد ماهانه
                </p>
            </div>
        </div>
    </div>

    <!-- System Health -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6 hover:shadow-xl dark:hover:shadow-cyber-neon-danger/10 transition-all duration-300">
        <div class="flex items-center">
            <div class="p-3 rounded-full bg-red-100 dark:bg-cyber-neon-danger/20">
                <svg class="w-8 h-8 text-red-600 dark:text-cyber-neon-danger" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                </svg>
            </div>
            <div class="mr-4">
                <p class="text-sm font-medium text-gray-600 dark:text-cyber-text-secondary">وضعیت سیستم</p>
                <p class="text-2xl font-bold text-green-600 dark:text-cyber-neon-secondary" x-text="systemStatus">سالم</p>
                <p class="text-xs text-gray-500 dark:text-cyber-text-muted mt-1">
                    <span class="persian-numbers">{{ uptime_percentage }}%</span> آپتایم
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Unified Navigation Sections -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
    <!-- Tenant Management Section -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6">
        <div class="flex items-center mb-4">
            <div class="p-2 rounded-lg bg-blue-100 dark:bg-cyber-neon-primary/20 ml-3">
                <svg class="w-6 h-6 text-blue-600 dark:text-cyber-neon-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-cyber-text-primary">مدیریت تنانت‌ها</h3>
        </div>
        <div class="space-y-3">
            <a href="{% url 'admin_panel:tenants:tenant_list' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">مشاهده همه تنانت‌ها</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:tenants:tenant_create' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">ایجاد تنانت جدید</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:tenants:tenant_search' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">جستجو و عملیات گروهی</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
        </div>
    </div>

    <!-- User Impersonation Section -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6">
        <div class="flex items-center mb-4">
            <div class="p-2 rounded-lg bg-purple-100 dark:bg-cyber-neon-purple/20 ml-3">
                <svg class="w-6 h-6 text-purple-600 dark:text-cyber-neon-purple" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-cyber-text-primary">مدیریت کاربران</h3>
        </div>
        <div class="space-y-3">
            <a href="{% url 'admin_panel:user_impersonation' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">جایگزینی کاربر</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:impersonation_audit' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">گزارش‌های حسابرسی</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:impersonation_stats' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">آمار و گزارش‌ها</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
        </div>
    </div>

    <!-- System Health Section -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6">
        <div class="flex items-center mb-4">
            <div class="p-2 rounded-lg bg-green-100 dark:bg-cyber-neon-secondary/20 ml-3">
                <svg class="w-6 h-6 text-green-600 dark:text-cyber-neon-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-cyber-text-primary">نظارت سیستم</h3>
        </div>
        <div class="space-y-3">
            <a href="{% url 'admin_panel:system_health_dashboard' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">داشبورد سلامت سیستم</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:system_health_alerts' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">هشدارها و اعلان‌ها</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:system_health_reports' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">گزارش‌های عملکرد</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
        </div>
    </div>
</div>

<!-- Second Row of Sections -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
    <!-- Backup & Recovery Section -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6">
        <div class="flex items-center mb-4">
            <div class="p-2 rounded-lg bg-orange-100 dark:bg-cyber-neon-tertiary/20 ml-3">
                <svg class="w-6 h-6 text-orange-600 dark:text-cyber-neon-tertiary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-cyber-text-primary">پشتیبان‌گیری</h3>
        </div>
        <div class="space-y-3">
            <a href="{% url 'admin_panel:backup_management' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">مدیریت پشتیبان</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:backup_history' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">تاریخچه پشتیبان</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:tenant_restore' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">بازیابی تنانت</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:disaster_recovery_dashboard' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">بازیابی فاجعه</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
        </div>
    </div>

    <!-- Billing & Subscriptions Section -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6">
        <div class="flex items-center mb-4">
            <div class="p-2 rounded-lg bg-yellow-100 dark:bg-cyber-neon-warning/20 ml-3">
                <svg class="w-6 h-6 text-yellow-600 dark:text-cyber-neon-warning" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-cyber-text-primary">مدیریت مالی</h3>
        </div>
        <div class="space-y-3">
            <a href="{% url 'admin_panel:tenants:billing:dashboard' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">داشبورد مالی</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:tenants:billing:subscription_plans' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">پلن‌های اشتراک</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:tenants:billing:invoices' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">مدیریت فاکتورها</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="{% url 'admin_panel:tenants:billing:reports' %}" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">گزارش‌های درآمد</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
        </div>
    </div>

    <!-- Security & Audit Section -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6">
        <div class="flex items-center mb-4">
            <div class="p-2 rounded-lg bg-red-100 dark:bg-cyber-neon-danger/20 ml-3">
                <svg class="w-6 h-6 text-red-600 dark:text-cyber-neon-danger" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                </svg>
            </div>
            <h3 class="text-lg font-semibold text-gray-900 dark:text-cyber-text-primary">امنیت و حسابرسی</h3>
        </div>
        <div class="space-y-3">
            <a href="#" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">داشبورد امنیت</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="#" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">لاگ‌های حسابرسی</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="#" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">رویدادهای امنیتی</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
            <a href="#" 
               class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg hover:bg-gray-100 dark:hover:bg-cyber-bg-elevated/80 transition-colors group">
                <span class="text-gray-700 dark:text-cyber-text-secondary group-hover:text-gray-900 dark:group-hover:text-cyber-neon-primary">کنترل دسترسی</span>
                <svg class="w-4 h-4 text-gray-400 dark:text-cyber-text-muted mr-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </a>
        </div>
    </div>
</div>

<!-- Recent Activity and Alerts -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Recent Activity -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-cyber-text-primary mb-4">فعالیت‌های اخیر</h3>
        <div class="space-y-4" x-data="recentActivity()">
            <template x-for="activity in activities" :key="activity.id">
                <div class="flex items-center p-3 bg-gray-50 dark:bg-cyber-bg-elevated rounded-lg">
                    <div class="p-2 rounded-full bg-blue-100 dark:bg-cyber-neon-primary/20 ml-3">
                        <svg class="w-4 h-4 text-blue-600 dark:text-cyber-neon-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-900 dark:text-cyber-text-primary" x-text="activity.description"></p>
                        <p class="text-xs text-gray-500 dark:text-cyber-text-muted" x-text="activity.time"></p>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- System Alerts -->
    <div class="bg-white dark:bg-cyber-bg-surface rounded-lg shadow-lg dark:shadow-2xl p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-cyber-text-primary mb-4">هشدارهای سیستم</h3>
        <div class="space-y-4" x-data="systemAlerts()">
            <template x-for="alert in alerts" :key="alert.id">
                <div class="flex items-center p-3 rounded-lg" :class="alert.type === 'warning' ? 'bg-yellow-50 dark:bg-cyber-neon-warning/10' : alert.type === 'error' ? 'bg-red-50 dark:bg-cyber-neon-danger/10' : 'bg-green-50 dark:bg-cyber-neon-secondary/10'">
                    <div class="p-2 rounded-full ml-3" :class="alert.type === 'warning' ? 'bg-yellow-100 dark:bg-cyber-neon-warning/20' : alert.type === 'error' ? 'bg-red-100 dark:bg-cyber-neon-danger/20' : 'bg-green-100 dark:bg-cyber-neon-secondary/20'">
                        <svg class="w-4 h-4" :class="alert.type === 'warning' ? 'text-yellow-600 dark:text-cyber-neon-warning' : alert.type === 'error' ? 'text-red-600 dark:text-cyber-neon-danger' : 'text-green-600 dark:text-cyber-neon-secondary'" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-medium" :class="alert.type === 'warning' ? 'text-yellow-800 dark:text-cyber-neon-warning' : alert.type === 'error' ? 'text-red-800 dark:text-cyber-neon-danger' : 'text-green-800 dark:text-cyber-neon-secondary'" x-text="alert.title"></p>
                        <p class="text-xs" :class="alert.type === 'warning' ? 'text-yellow-600 dark:text-cyber-neon-warning/80' : alert.type === 'error' ? 'text-red-600 dark:text-cyber-neon-danger/80' : 'text-green-600 dark:text-cyber-neon-secondary/80'" x-text="alert.message"></p>
                    </div>
                </div>
            </template>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Statistics Data Management
    function statisticsData() {
        return {
            totalTenants: {{ total_tenants }},
            activeTenants: {{ active_tenants }},
            totalRevenue: {{ total_revenue|default:0 }},
            systemStatus: 'سالم',
            
            formatCurrency(amount) {
                return new Intl.NumberFormat('fa-IR').format(amount) + ' تومان';
            },
            
            async refreshStats() {
                try {
                    const response = await fetch('/super-panel/api/stats/');
                    const data = await response.json();
                    this.totalTenants = data.total_tenants;
                    this.activeTenants = data.active_tenants;
                    this.totalRevenue = data.total_revenue;
                    this.systemStatus = data.system_status;
                } catch (error) {
                    console.error('Error refreshing stats:', error);
                }
            },
            
            init() {
                // Refresh stats every 30 seconds
                setInterval(() => this.refreshStats(), 30000);
            }
        }
    }
    
    // Recent Activity Management
    function recentActivity() {
        return {
            activities: [
                {
                    id: 1,
                    description: 'تنانت جدید "طلای پارس" ایجاد شد',
                    time: '۵ دقیقه پیش'
                },
                {
                    id: 2,
                    description: 'پشتیبان خودکار سیستم تکمیل شد',
                    time: '۱۵ دقیقه پیش'
                },
                {
                    id: 3,
                    description: 'کاربر admin وارد تنانت "زرگری نقره" شد',
                    time: '۳۰ دقیقه پیش'
                }
            ],
            
            async loadActivities() {
                try {
                    const response = await fetch('/super-panel/api/recent-activity/');
                    const data = await response.json();
                    this.activities = data.activities;
                } catch (error) {
                    console.error('Error loading activities:', error);
                }
            },
            
            init() {
                this.loadActivities();
                // Refresh activities every 60 seconds
                setInterval(() => this.loadActivities(), 60000);
            }
        }
    }
    
    // System Alerts Management
    function systemAlerts() {
        return {
            alerts: [
                {
                    id: 1,
                    type: 'success',
                    title: 'سیستم سالم',
                    message: 'تمام سرویس‌ها به درستی کار می‌کنند'
                },
                {
                    id: 2,
                    type: 'warning',
                    title: 'فضای دیسک',
                    message: 'فضای دیسک کمتر از ۲۰٪ باقی مانده'
                }
            ],
            
            async loadAlerts() {
                try {
                    const response = await fetch('/super-panel/api/system-alerts/');
                    const data = await response.json();
                    this.alerts = data.alerts;
                } catch (error) {
                    console.error('Error loading alerts:', error);
                }
            },
            
            init() {
                this.loadAlerts();
                // Refresh alerts every 30 seconds
                setInterval(() => this.loadAlerts(), 30000);
            }
        }
    }
    
    // Theme Management
    function toggleTheme() {
        const isDark = document.documentElement.classList.contains('dark');
        if (isDark) {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light');
        } else {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark');
        }
    }
    
    // Initialize theme on page load
    document.addEventListener('DOMContentLoaded', function() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        }
    });
</script>
{% endblock %}